<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Common Finite Difference Stencils (Filters) · Bocheng Zeng's BLOG</title><meta name="description" content="Common Finite Difference Stencils (Filters) - Bocheng Zeng"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/hermes.css"><link rel="search" type="application/opensearchdescription+xml" href="https://zengbocheng.github.io/atom.xml" title="Bocheng Zeng's BLOG"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Bocheng Zeng's BLOG" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">FEED</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Common Finite Difference Stencils (Filters)</h1><div class="post-info">Oct 22, 2022</div><div class="post-content"><p>Here is some common FD stenciles.</p>
<span id="more"></span>
<h1 id="Common-FD-Stencils"><a href="#Common-FD-Stencils" class="headerlink" title="Common FD Stencils"></a>Common FD Stencils</h1><h2 id="First-order-derivative"><a href="#First-order-derivative" class="headerlink" title="First order derivative"></a>First order derivative</h2><h3 id="Cental-difference-two-side-5-point-stencil"><a href="#Cental-difference-two-side-5-point-stencil" class="headerlink" title="Cental difference (two-side 5-point stencil)"></a>Cental difference (two-side 5-point stencil)</h3><script type="math/tex; mode=display">
\frac{\partial f(x)}{\partial x} \approx \frac{1f(x-2h) - 8f(x-1h)+0f(x+0h)+8f(x+1h)-1f(x+2h)}{12h}</script><h3 id="Forwad-difference-one-side-5-point-stencil"><a href="#Forwad-difference-one-side-5-point-stencil" class="headerlink" title="Forwad difference (one-side 5-point stencil)"></a>Forwad difference (one-side 5-point stencil)</h3><script type="math/tex; mode=display">
\frac{\partial f(x)}{\partial x} \approx \frac{3f(x-4h)-16f(x-3h)+36f(x-2h)-48f(x-1h)+25f(x+0h)}{12h}</script><h3 id="Backward-difference-one-side-5-point-stencil"><a href="#Backward-difference-one-side-5-point-stencil" class="headerlink" title="Backward difference (one-side 5-point stencil)"></a>Backward difference (one-side 5-point stencil)</h3><script type="math/tex; mode=display">
\frac{\partial f(x)}{\partial x} \approx \frac{-25f(x+0h) + 48f(x+1h)-36f(x+2h)+16f(x+3h)-3f(x+4h)}{12h}</script><h2 id="Second-order-derivative"><a href="#Second-order-derivative" class="headerlink" title="Second order derivative"></a>Second order derivative</h2><h3 id="Central-difference"><a href="#Central-difference" class="headerlink" title="Central difference"></a>Central difference</h3><script type="math/tex; mode=display">
\frac{\partial^2 f(x)}{\partial x^2} \approx \frac{-1f(x-2h)+16f(x-1h)-30f(x+0h)+16f(x+1h)-1f(x+2h)}{12h^2}</script><h3 id="Forward-difference"><a href="#Forward-difference" class="headerlink" title="Forward difference"></a>Forward difference</h3><script type="math/tex; mode=display">
\frac{\partial^2f(x)}{\partial x^2} \approx \frac{11f(x-4h)-56f(x-3h)+114f(x-2h)-104f(x-1h)+35f(x+0h)}{12h^2}</script><h3 id="Backward-difference"><a href="#Backward-difference" class="headerlink" title="Backward difference"></a>Backward difference</h3><script type="math/tex; mode=display">
\frac{\partial^2 f(x)}{\partial x^2} \approx \frac{35f(x+0h)-104f(x+1h)+114f(x+2h)-56f(x+3h)+11f(x+4h)}{12h^2}</script><h3 id="A-useful-link"><a href="#A-useful-link" class="headerlink" title="A useful link"></a>A useful link</h3><p>Online tool for computing coefficients of arbitrary differential operators: <a target="_blank" rel="noopener" href="https://web/">https://web.</a><a target="_blank" rel="noopener" href="http://media.mit.edu/~crtaylor/calculator.html">media.mit.edu/~crtaylor/calculator.html</a></p>
<h1 id="The-Derivatives-on-the-Boundary"><a href="#The-Derivatives-on-the-Boundary" class="headerlink" title="The Derivatives on the Boundary"></a>The Derivatives on the Boundary</h1><p><strong>1. One-side finite difference stencils:</strong> To calculate the derivatives through FD method, central difference scheme is typically a good choice as it is symmetrical and accurate. However, it is usually applied in the inner domain because it requires “information” on both side of a point. To avoid this requirement, we could alternatively utilize the one-side FD stencils (such as forward or backward difference) to compute the derivative on the boundary. That is saying, you would need to apply different FD stencils (i.e., central difference on inner domain while forward/backward difference on boundaries) on the input “image”.</p>
<p><strong>2. Padding:</strong> The basic idea is to pad the input “image” according to the prescribed boundary condition and then utilize a consistent FD stencil (i.e., central difference on the entire domain) to compute the derivative. The padded point is also known as ghost/virtual/fictional point (or node) in traditional FD method. A good example on how ghost points work can be found in <a target="_blank" rel="noopener" href="https://personal.math.ubc.ca/~njb/fd.pdf">https://personal.math.ubc.ca/~njb/fd.pdf</a>.</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Finite_difference">https://en.wikipedia.org/wiki/Finite_difference</a></p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2022/10/23/1D%20Conv,%202D%20Conv%20and%202D%20ConvTranspose/">PREV</a><a class="next" href="/2022/10/17/%E6%95%B0%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%BC%A0%E9%87%8F%E8%BF%90%E7%AE%97/">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'bochengzeng';
var disqus_identifier = '2022/10/22/Common Finite Difference Stencils (Filters)/';
var disqus_title = 'Common Finite Difference Stencils (Filters)';
var disqus_url = 'https://zengbocheng.github.io/2022/10/22/Common Finite Difference Stencils (Filters)/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>© 2022 <a href="https://zengbocheng.github.io">Bocheng Zeng</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/claymcleod/hexo-theme-hermes" target="_blank">hexo-theme-hermes</a>. </p><p>Logo made by <a target="_blank" rel="noopener" href="https://www.flaticon.com/authors/freepik">Freepik</a> from <a target="_blank" rel="noopener" href="https://flaticon.com">www.flaticon.com</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>